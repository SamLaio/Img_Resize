jQuery.fn.extend({imgResize: function (settings) {var config = {'width': 780};var dim_img = this.find('img');var img_arr = new Array();var img_boolean = false;if (settings){$.extend(config, settings);}if(dim_img.length > 0){for(var i = 0; i < dim_img.length; i++){img_arr[i] = new Array();if(dim_img[i].complete){if(detectBrowser()){img_arr[i][0] = dim_img[i].naturalWidth;img_arr[i][1] = dim_img[i].naturalHeight;}else{var natural = getNatural(dim_img[i]);img_arr[i][0] = natural.width;img_arr[i][1] = natural.width;}}}img_resize();}function detectBrowser(){var sAgent = navigator.userAgent.toLowerCase();sAgent = sAgent.split('; ');var age = '';for(var i = 0; i < sAgent.length; i++){if(sAgent[i].indexOf('msie') != -1){age = sAgent[i].split(' ');age=Math.floor(age[1]);return (age > 9);}}return true;}function getNatural (DOMelement) {var img = new Image();img.src = DOMelement.src;return {width: img.width, height: img.height};}$(window).resize(function(){img_resize();});function img_resize(){for(var i = 0; i < dim_img.length; i++){var img_w = img_arr[i][0];var img_h = img_arr[i][1];var re_w = img_w;var re_h = img_h;if(dim_img[i].width > $(window).width()){if(parseInt(img_w) > config.width){re_w = config.width * 0.9;re_h = parseInt(config.width * img_h / img_w) * 0.9 ;}if(parseInt(img_w) > $(window).width()){re_w = $(window).width() * 0.9;re_h = parseInt($(window).width() * img_h / img_w) * 0.9 ;}}else{re_w = dim_img[i].width;re_h = dim_img[i].height;}re_w = re_w  + 'px';re_h = re_h + 'px';dim_img[i].style.width = re_w;dim_img[i].style.height = re_h;}}}});